(function () {
    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
    var __module = nodeEnv ? module : { exports: {} };
    var __filename = 'engine-dev/cocos2d/renderer/gfx/vertex-buffer.js';
    var __require = nodeEnv ? function (request) {
        return require(request);
    } : function (request) {
        return __quick_compile__.require(request, __filename);
    };
    function __define(exports, require, module) {
        if (!nodeEnv) {
            __quick_compile__.registerModule(__filename, module);
        }
                'use strict';
        Object.defineProperty(exports, '__esModule', { value: true });
        var _createClass = function () {
            function defineProperties(target, props) {
                for (var i = 0; i < props.length; i++) {
                    var descriptor = props[i];
                    descriptor.enumerable = descriptor.enumerable || false;
                    descriptor.configurable = true;
                    if ('value' in descriptor)
                        descriptor.writable = true;
                    Object.defineProperty(target, descriptor.key, descriptor);
                }
            }
            return function (Constructor, protoProps, staticProps) {
                if (protoProps)
                    defineProperties(Constructor.prototype, protoProps);
                if (staticProps)
                    defineProperties(Constructor, staticProps);
                return Constructor;
            };
        }();
        var _enums = require('./enums');
        function _classCallCheck(instance, Constructor) {
            if (!(instance instanceof Constructor)) {
                throw new TypeError('Cannot call a class as a function');
            }
        }
        var VertexBuffer = function () {
            function VertexBuffer(device, format, usage, data, numVertices) {
                _classCallCheck(this, VertexBuffer);
                this._device = device;
                this._format = format;
                this._usage = usage;
                this._numVertices = numVertices;
                this._bytes = this._format._bytes * numVertices;
                this._glID = device._gl.createBuffer();
                this.update(0, data);
                device._stats.vb += this._bytes;
            }
            _createClass(VertexBuffer, [
                {
                    key: 'destroy',
                    value: function destroy() {
                        if (this._glID === -1) {
                            console.error('The buffer already destroyed');
                            return;
                        }
                        var gl = this._device._gl;
                        gl.deleteBuffer(this._glID);
                        this._device._stats.vb -= this.bytes;
                        this._glID = -1;
                    }
                },
                {
                    key: 'update',
                    value: function update(offset, data) {
                        if (this._glID === -1) {
                            console.error('The buffer is destroyed');
                            return;
                        }
                        if (data && data.byteLength + offset > this._bytes) {
                            console.error('Failed to update data, bytes exceed.');
                            return;
                        }
                        var gl = this._device._gl;
                        var glUsage = this._usage;
                        gl.bindBuffer(gl.ARRAY_BUFFER, this._glID);
                        if (!data) {
                            if (this._bytes) {
                                gl.bufferData(gl.ARRAY_BUFFER, this._bytes, glUsage);
                            } else {
                                console.warn('bufferData should not submit 0 bytes data');
                            }
                        } else {
                            if (offset) {
                                gl.bufferSubData(gl.ARRAY_BUFFER, offset, data);
                            } else {
                                gl.bufferData(gl.ARRAY_BUFFER, data, glUsage);
                            }
                        }
                        gl.bindBuffer(gl.ARRAY_BUFFER, null);
                    }
                },
                {
                    key: 'count',
                    get: function get() {
                        return this._numVertices;
                    }
                }
            ]);
            return VertexBuffer;
        }();
        exports.default = VertexBuffer;
        module.exports = exports['default'];
    }
    if (nodeEnv) {
        __define(__module.exports, __require, __module);
    } else {
        __quick_compile__.registerModuleFunc(__filename, function () {
            __define(__module.exports, __require, __module);
        });
    }
}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlcnRleC1idWZmZXIuanMiLCIvVXNlcnMvenpmMjAxOS9EZXNrdG9wL2RldmVsb3BtZW50L3N1cHBvcnRfYXN0Yy9lbmdpbmUvY29jb3MyZC9yZW5kZXJlci9nZngvdmVydGV4LWJ1ZmZlci5qcyJdLCJuYW1lcyI6WyJWZXJ0ZXhCdWZmZXIiLCJkZXZpY2UiLCJmb3JtYXQiLCJ1c2FnZSIsImRhdGEiLCJudW1WZXJ0aWNlcyIsIl9kZXZpY2UiLCJfZm9ybWF0IiwiX3VzYWdlIiwiX251bVZlcnRpY2VzIiwiX2J5dGVzIiwiX2dsSUQiLCJfZ2wiLCJjcmVhdGVCdWZmZXIiLCJ1cGRhdGUiLCJfc3RhdHMiLCJ2YiIsImNvbnNvbGUiLCJlcnJvciIsImdsIiwiZGVsZXRlQnVmZmVyIiwiYnl0ZXMiLCJvZmZzZXQiLCJieXRlTGVuZ3RoIiwiZ2xVc2FnZSIsImJpbmRCdWZmZXIiLCJBUlJBWV9CVUZGRVIiLCJidWZmZXJEYXRhIiwid2FybiIsImJ1ZmZlclN1YkRhdGEiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7UUFBQSxPQUFBLGlCQUFBLENBQUEsT0FBQSxDQUFBLE9BQUEsRUFBQSxVQUFBLENBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztRQUFBLElBQUEsTUFBQSxHQUFBLE9BQUEsQ0FBQSxTQUFBLENBQUE7Ozs7OztZQUVNQSxZQUFBQTtZQVNKLFNBQUEsWUFBQSxDQUFZQyxNQUFaLEVBQW9CQyxNQUFwQixFQUE0QkMsS0FBNUIsRUFBbUNDLElBQW5DLEVBQXlDQyxXQUF6QyxFQUFzRDtBQUFBLGdCQUFBLGVBQUEsQ0FBQSxJQUFBLEVBQUEsWUFBQSxFQUFBO0FBQUEsZ0JBQ3BELEtBQUtDLE9BQUwsR0FBZUwsTUFBZixDQURvRDtBQUFBLGdCQUVwRCxLQUFLTSxPQUFMLEdBQWVMLE1BQWYsQ0FGb0Q7QUFBQSxnQkFHcEQsS0FBS00sTUFBTCxHQUFjTCxLQUFkLENBSG9EO0FBQUEsZ0JBSXBELEtBQUtNLFlBQUwsR0FBb0JKLFdBQXBCLENBSm9EO0FB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QUEsS0FBQSIsImZpbGUiOiJ2ZXJ0ZXgtYnVmZmVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZW51bXMgfSBmcm9tICcuL2VudW1zJztcblxuY2xhc3MgVmVydGV4QnVmZmVyIHtcbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge0RldmljZX0gZGV2aWNlXG4gICAqIEBwYXJhbSB7VmVydGV4Rm9ybWF0fSBmb3JtYXRcbiAgICogQHBhcmFtIHtVU0FHRV8qfSB1c2FnZVxuICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyIHwgVWludDhBcnJheX0gZGF0YVxuICAgKiBAcGFyYW0ge051bWJlcn0gbnVtVmVydGljZXNcbiAgICovXG4gIGNvbnN0cnVjdG9yKGRldmljZSwgZm9ybWF0LCB1c2FnZSwgZGF0YSwgbnVtVmVydGljZXMpIHtcbiAgICB0aGlzLl9kZXZpY2UgPSBkZXZpY2U7XG4gICAgdGhpcy5fZm9ybWF0ID0gZm9ybWF0O1xuICAgIHRoaXMuX3VzYWdlID0gdXNhZ2U7XG4gICAgdGhpcy5fbnVtVmVydGljZXMgPSBudW1WZXJ0aWNlcztcblxuICAgIC8vIGNhbGN1bGF0ZSBieXRlc1xuICAgIHRoaXMuX2J5dGVzID0gdGhpcy5fZm9ybWF0Ll9ieXRlcyAqIG51bVZlcnRpY2VzO1xuXG4gICAgLy8gdXBkYXRlXG4gICAgdGhpcy5fZ2xJRCA9IGRldmljZS5fZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgdGhpcy51cGRhdGUoMCwgZGF0YSk7XG5cbiAgICAvLyBzdGF0c1xuICAgIGRldmljZS5fc3RhdHMudmIgKz0gdGhpcy5fYnl0ZXM7XG4gIH1cblxuICAvKipcbiAgICogQG1ldGhvZCBkZXN0cm95XG4gICAqL1xuICBkZXN0cm95KCkge1xuICAgIGlmICh0aGlzLl9nbElEID09PSAtMSkge1xuICAgICAgY29uc29sZS5lcnJvcignVGhlIGJ1ZmZlciBhbHJlYWR5IGRlc3Ryb3llZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBnbCA9IHRoaXMuX2RldmljZS5fZ2w7XG4gICAgZ2wuZGVsZXRlQnVmZmVyKHRoaXMuX2dsSUQpO1xuICAgIHRoaXMuX2RldmljZS5fc3RhdHMudmIgLT0gdGhpcy5ieXRlcztcblxuICAgIHRoaXMuX2dsSUQgPSAtMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAbWV0aG9kIHVwZGF0ZVxuICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0XG4gICAqIEBwYXJhbSB7QXJyYXlCdWZmZXJ9IGRhdGFcbiAgICovXG4gIHVwZGF0ZShvZmZzZXQsIGRhdGEpIHtcbiAgICBpZiAodGhpcy5fZ2xJRCA9PT0gLTEpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RoZSBidWZmZXIgaXMgZGVzdHJveWVkJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGRhdGEgJiYgZGF0YS5ieXRlTGVuZ3RoICsgb2Zmc2V0ID4gdGhpcy5fYnl0ZXMpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byB1cGRhdGUgZGF0YSwgYnl0ZXMgZXhjZWVkLicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBnbCA9IHRoaXMuX2RldmljZS5fZ2w7XG4gICAgbGV0IGdsVXNhZ2UgPSB0aGlzLl91c2FnZTtcblxuICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCB0aGlzLl9nbElEKTtcbiAgICBpZiAoIWRhdGEpIHtcbiAgICAgIGlmICh0aGlzLl9ieXRlcykge1xuICAgICAgICBnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgdGhpcy5fYnl0ZXMsIGdsVXNhZ2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdidWZmZXJEYXRhIHNob3VsZCBub3Qgc3VibWl0IDAgYnl0ZXMgZGF0YScpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAob2Zmc2V0KSB7XG4gICAgICAgIGdsLmJ1ZmZlclN1YkRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBvZmZzZXQsIGRhdGEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZ2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIGRhdGEsIGdsVXNhZ2UpO1xuICAgICAgfVxuICAgIH1cbiAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgbnVsbCk7XG4gIH1cblxuICBnZXQgY291bnQgKCkge1xuICAgIHJldHVybiB0aGlzLl9udW1WZXJ0aWNlcztcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBWZXJ0ZXhCdWZmZXI7XG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZW51bXMgPSByZXF1aXJlKCcuL2VudW1zJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBWZXJ0ZXhCdWZmZXIgPSBmdW5jdGlvbiAoKSB7XG4gIC8qKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtEZXZpY2V9IGRldmljZVxuICAgKiBAcGFyYW0ge1ZlcnRleEZvcm1hdH0gZm9ybWF0XG4gICAqIEBwYXJhbSB7VVNBR0VfKn0gdXNhZ2VcbiAgICogQHBhcmFtIHtBcnJheUJ1ZmZlciB8IFVpbnQ4QXJyYXl9IGRhdGFcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG51bVZlcnRpY2VzXG4gICAqL1xuICBmdW5jdGlvbiBWZXJ0ZXhCdWZmZXIoZGV2aWNlLCBmb3JtYXQsIHVzYWdlLCBkYXRhLCBudW1WZXJ0aWNlcykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWZXJ0ZXhCdWZmZXIpO1xuXG4gICAgdGhpcy5fZGV2aWNlID0gZGV2aWNlO1xuICAgIHRoaXMuX2Zvcm1hdCA9IGZvcm1hdDtcbiAgICB0aGlzLl91c2FnZSA9IHVzYWdlO1xuICAgIHRoaXMuX251bVZlcnRpY2VzID0gbnVtVmVydGljZXM7XG5cbiAgICAvLyBjYWxjdWxhdGUgYnl0ZXNcbiAgICB0aGlzLl9ieXRlcyA9IHRoaXMuX2Zvcm1hdC5fYnl0ZXMgKiBudW1WZXJ0aWNlcztcblxuICAgIC8vIHVwZGF0ZVxuICAgIHRoaXMuX2dsSUQgPSBkZXZpY2UuX2dsLmNyZWF0ZUJ1ZmZlcigpO1xuICAgIHRoaXMudXBkYXRlKDAsIGRhdGEpO1xuXG4gICAgLy8gc3RhdHNcbiAgICBkZXZpY2UuX3N0YXRzLnZiICs9IHRoaXMuX2J5dGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIEBtZXRob2QgZGVzdHJveVxuICAgKi9cblxuXG4gIF9jcmVhdGVDbGFzcyhWZXJ0ZXhCdWZmZXIsIFt7XG4gICAga2V5OiAnZGVzdHJveScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICBpZiAodGhpcy5fZ2xJRCA9PT0gLTEpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignVGhlIGJ1ZmZlciBhbHJlYWR5IGRlc3Ryb3llZCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBnbCA9IHRoaXMuX2RldmljZS5fZ2w7XG4gICAgICBnbC5kZWxldGVCdWZmZXIodGhpcy5fZ2xJRCk7XG4gICAgICB0aGlzLl9kZXZpY2UuX3N0YXRzLnZiIC09IHRoaXMuYnl0ZXM7XG5cbiAgICAgIHRoaXMuX2dsSUQgPSAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIHVwZGF0ZVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBvZmZzZXRcbiAgICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBkYXRhXG4gICAgICovXG5cbiAgfSwge1xuICAgIGtleTogJ3VwZGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZShvZmZzZXQsIGRhdGEpIHtcbiAgICAgIGlmICh0aGlzLl9nbElEID09PSAtMSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdUaGUgYnVmZmVyIGlzIGRlc3Ryb3llZCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChkYXRhICYmIGRhdGEuYnl0ZUxlbmd0aCArIG9mZnNldCA+IHRoaXMuX2J5dGVzKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byB1cGRhdGUgZGF0YSwgYnl0ZXMgZXhjZWVkLicpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBnbCA9IHRoaXMuX2RldmljZS5fZ2w7XG4gICAgICB2YXIgZ2xVc2FnZSA9IHRoaXMuX3VzYWdlO1xuXG4gICAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgdGhpcy5fZ2xJRCk7XG4gICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMuX2J5dGVzKSB7XG4gICAgICAgICAgZ2wuYnVmZmVyRGF0YShnbC5BUlJBWV9CVUZGRVIsIHRoaXMuX2J5dGVzLCBnbFVzYWdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ2J1ZmZlckRhdGEgc2hvdWxkIG5vdCBzdWJtaXQgMCBieXRlcyBkYXRhJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICBnbC5idWZmZXJTdWJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgb2Zmc2V0LCBkYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgZGF0YSwgZ2xVc2FnZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGdsLmJpbmRCdWZmZXIoZ2wuQVJSQVlfQlVGRkVSLCBudWxsKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdjb3VudCcsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbnVtVmVydGljZXM7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFZlcnRleEJ1ZmZlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gVmVydGV4QnVmZmVyO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtODtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSnpiM1Z5WTJWeklqcGJJblpsY25SbGVDMWlkV1ptWlhJdWFuTWlYU3dpYm1GdFpYTWlPbHNpVm1WeWRHVjRRblZtWm1WeUlpd2laR1YyYVdObElpd2labTl5YldGMElpd2lkWE5oWjJVaUxDSmtZWFJoSWl3aWJuVnRWbVZ5ZEdsalpYTWlMQ0pmWkdWMmFXTmxJaXdpWDJadmNtMWhkQ0lzSWw5MWMyRm5aU0lzSWw5dWRXMVdaWEowYVdObGN5SXNJbDlpZVhSbGN5SXNJbDluYkVsRUlpd2lYMmRzSWl3aVkzSmxZWFJsUW5WbVptVnlJaXdpZFhCa1lYUmxJaXdpWDNOMFlYUnpJaXdpZG1JaUxDSmpiMjV6YjJ4bElpd2laWEp5YjNJaUxDSm5iQ0lzSW1SbGJHVjBaVUoxWm1abGNpSXNJbUo1ZEdWeklpd2liMlptYzJWMElpd2lZbmwwWlV4bGJtZDBhQ0lzSW1kc1ZYTmhaMlVpTENKaWFXNWtRblZtWm1WeUlpd2lRVkpTUVZsZlFsVkdSa1ZTSWl3aVluVm1abVZ5UkdGMFlTSXNJbmRoY200aUxDSmlkV1ptWlhKVGRXSkVZWFJoSWwwc0ltMWhjSEJwYm1keklqb2lPenM3T3pzN096dEJRVUZCT3pzN08wbEJSVTFCTEZrN1FVRkRTanM3T3pzN096czdRVUZSUVN4M1FrRkJXVU1zVFVGQldpeEZRVUZ2UWtNc1RVRkJjRUlzUlVGQk5FSkRMRXRCUVRWQ0xFVkJRVzFEUXl4SlFVRnVReXhGUVVGNVEwTXNWMEZCZWtNc1JVRkJjMFE3UVVGQlFUczdRVUZEY0VRc1UwRkJTME1zVDBGQlRDeEhRVUZsVEN4TlFVRm1PMEZCUTBFc1UwRkJTMDBzVDBGQlRDeEhRVUZsVEN4TlFVRm1PMEZCUTBFc1UwRkJTMDBzVFVGQlRDeEhRVUZqVEN4TFFVRmtPMEZCUTBFc1UwRkJTMDBzV1VGQlRDeEhRVUZ2UWtvc1YwRkJjRUk3TzBGQlJVRTdRVUZEUVN4VFFVRkxTeXhOUVVGTUxFZEJRV01zUzBGQlMwZ3NUMEZCVEN4RFFVRmhSeXhOUVVGaUxFZEJRWE5DVEN4WFFVRndRenM3UVVGRlFUdEJRVU5CTEZOQlFVdE5MRXRCUVV3c1IwRkJZVllzVDBGQlQxY3NSMEZCVUN4RFFVRlhReXhaUVVGWUxFVkJRV0k3UVVGRFFTeFRRVUZMUXl4TlFVRk1MRU5CUVZrc1EwRkJXaXhGUVVGbFZpeEpRVUZtT3p0QlFVVkJPMEZCUTBGSUxGZEJRVTlqTEUxQlFWQXNRMEZCWTBNc1JVRkJaQ3hKUVVGdlFpeExRVUZMVGl4TlFVRjZRanRCUVVORU96dEJRVVZFT3pzN096czdPemhDUVVkVk8wRkJRMUlzVlVGQlNTeExRVUZMUXl4TFFVRk1MRXRCUVdVc1EwRkJReXhEUVVGd1FpeEZRVUYxUWp0QlFVTnlRazBzWjBKQlFWRkRMRXRCUVZJc1EwRkJZeXc0UWtGQlpEdEJRVU5CTzBGQlEwUTdPMEZCUlVRc1ZVRkJTVU1zUzBGQlN5eExRVUZMWWl4UFFVRk1MRU5CUVdGTkxFZEJRWFJDTzBGQlEwRlBMRk5CUVVkRExGbEJRVWdzUTBGQlowSXNTMEZCUzFRc1MwRkJja0k3UVVGRFFTeFhRVUZMVEN4UFFVRk1MRU5CUVdGVExFMUJRV0lzUTBGQmIwSkRMRVZCUVhCQ0xFbEJRVEJDTEV0QlFVdExMRXRCUVM5Q096dEJRVVZCTEZkQlFVdFdMRXRCUVV3c1IwRkJZU3hEUVVGRExFTkJRV1E3UVVGRFJEczdRVUZGUkRzN096czdPenM3TWtKQlMwOVhMRTBzUlVGQlVXeENMRWtzUlVGQlRUdEJRVU51UWl4VlFVRkpMRXRCUVV0UExFdEJRVXdzUzBGQlpTeERRVUZETEVOQlFYQkNMRVZCUVhWQ08wRkJRM0pDVFN4blFrRkJVVU1zUzBGQlVpeERRVUZqTEhsQ1FVRmtPMEZCUTBFN1FVRkRSRHM3UVVGRlJDeFZRVUZKWkN4UlFVRlJRU3hMUVVGTGJVSXNWVUZCVEN4SFFVRnJRa1FzVFVGQmJFSXNSMEZCTWtJc1MwRkJTMW9zVFVGQk5VTXNSVUZCYjBRN1FVRkRiRVJQTEdkQ1FVRlJReXhMUVVGU0xFTkJRV01zYzBOQlFXUTdRVUZEUVR0QlFVTkVPenRCUVVWRUxGVkJRVWxETEV0QlFVc3NTMEZCUzJJc1QwRkJUQ3hEUVVGaFRTeEhRVUYwUWp0QlFVTkJMRlZCUVVsWkxGVkJRVlVzUzBGQlMyaENMRTFCUVc1Q096dEJRVVZCVnl4VFFVRkhUU3hWUVVGSUxFTkJRV05PTEVkQlFVZFBMRmxCUVdwQ0xFVkJRU3RDTEV0QlFVdG1MRXRCUVhCRE8wRkJRMEVzVlVGQlNTeERRVUZEVUN4SlFVRk1MRVZCUVZjN1FVRkRWQ3haUVVGSkxFdEJRVXROTEUxQlFWUXNSVUZCYVVJN1FVRkRabE1zWVVGQlIxRXNWVUZCU0N4RFFVRmpVaXhIUVVGSFR5eFpRVUZxUWl4RlFVRXJRaXhMUVVGTGFFSXNUVUZCY0VNc1JVRkJORU5qTEU5QlFUVkRPMEZCUTBRc1UwRkdSQ3hOUVVWUE8wRkJRMHhRTEd0Q1FVRlJWeXhKUVVGU0xFTkJRV0VzTWtOQlFXSTdRVUZEUkR0QlFVTkdMRTlCVGtRc1RVRk5UenRCUVVOTUxGbEJRVWxPTEUxQlFVb3NSVUZCV1R0QlFVTldTQ3hoUVVGSFZTeGhRVUZJTEVOQlFXbENWaXhIUVVGSFR5eFpRVUZ3UWl4RlFVRnJRMG9zVFVGQmJFTXNSVUZCTUVOc1FpeEpRVUV4UXp0QlFVTkVMRk5CUmtRc1RVRkZUenRCUVVOTVpTeGhRVUZIVVN4VlFVRklMRU5CUVdOU0xFZEJRVWRQTEZsQlFXcENMRVZCUVN0Q2RFSXNTVUZCTDBJc1JVRkJjVU52UWl4UFFVRnlRenRCUVVORU8wRkJRMFk3UVVGRFJFd3NVMEZCUjAwc1ZVRkJTQ3hEUVVGalRpeEhRVUZIVHl4WlFVRnFRaXhGUVVFclFpeEpRVUV2UWp0QlFVTkVPenM3ZDBKQlJWazdRVUZEV0N4aFFVRlBMRXRCUVV0cVFpeFpRVUZhTzBGQlEwUTdPenM3T3p0clFrRkhXVlFzV1NJc0ltWnBiR1VpT2lKMlpYSjBaWGd0WW5WbVptVnlMbXB6SWl3aWMyOTFjbU5sYzBOdmJuUmxiblFpT2xzaWFXMXdiM0owSUhzZ1pXNTFiWE1nZlNCbWNtOXRJQ2N1TDJWdWRXMXpKenRjYmx4dVkyeGhjM01nVm1WeWRHVjRRblZtWm1WeUlIdGNiaUFnTHlvcVhHNGdJQ0FxSUVCamIyNXpkSEoxWTNSdmNseHVJQ0FnS2lCQWNHRnlZVzBnZTBSbGRtbGpaWDBnWkdWMmFXTmxYRzRnSUNBcUlFQndZWEpoYlNCN1ZtVnlkR1Y0Um05eWJXRjBmU0JtYjNKdFlYUmNiaUFnSUNvZ1FIQmhjbUZ0SUh0VlUwRkhSVjhxZlNCMWMyRm5aVnh1SUNBZ0tpQkFjR0Z5WVcwZ2UwRnljbUY1UW5WbVptVnlJSHdnVldsdWREaEJjbkpoZVgwZ1pHRjBZVnh1SUNBZ0tpQkFjR0Z5WVcwZ2UwNTFiV0psY24wZ2JuVnRWbVZ5ZEdsalpYTmNiaUFnSUNvdlhHNGdJR052Ym5OMGNuVmpkRzl5S0dSbGRtbGpaU3dnWm05eWJXRjBMQ0IxYzJGblpTd2daR0YwWVN3Z2JuVnRWbVZ5ZEdsalpYTXBJSHRjYmlBZ0lDQjBhR2x6TGw5a1pYWnBZMlVnUFNCa1pYWnBZMlU3WEc0Z0lDQWdkR2hwY3k1ZlptOXliV0YwSUQwZ1ptOXliV0YwTzF4dUlDQWdJSFJvYVhNdVgzVnpZV2RsSUQwZ2RYTmhaMlU3WEc0Z0lDQWdkR2hwY3k1ZmJuVnRWbVZ5ZEdsalpYTWdQU0J1ZFcxV1pYSjBhV05sY3p0Y2JseHVJQ0FnSUM4dklHTmhiR04xYkdGMFpTQmllWFJsYzF4dUlDQWdJSFJvYVhNdVgySjVkR1Z6SUQwZ2RHaHBjeTVmWm05eWJXRjBMbDlpZVhSbGN5QXFJRzUxYlZabGNuUnBZMlZ6TzF4dVhHNGdJQ0FnTHk4Z2RYQmtZWFJsWEc0Z0lDQWdkR2hwY3k1ZloyeEpSQ0E5SUdSbGRtbGpaUzVmWjJ3dVkzSmxZWFJsUW5WbVptVnlLQ2s3WEc0Z0lDQWdkR2hwY3k1MWNHUmhkR1VvTUN3Z1pHRjBZU2s3WEc1Y2JpQWdJQ0F2THlCemRHRjBjMXh1SUNBZ0lHUmxkbWxqWlM1ZmMzUmhkSE11ZG1JZ0t6MGdkR2hwY3k1ZllubDBaWE03WEc0Z0lIMWNibHh1SUNBdktpcGNiaUFnSUNvZ1FHMWxkR2h2WkNCa1pYTjBjbTk1WEc0Z0lDQXFMMXh1SUNCa1pYTjBjbTk1S0NrZ2UxeHVJQ0FnSUdsbUlDaDBhR2x6TGw5bmJFbEVJRDA5UFNBdE1Ta2dlMXh1SUNBZ0lDQWdZMjl1YzI5c1pTNWxjbkp2Y2lnblZHaGxJR0oxWm1abGNpQmhiSEpsWVdSNUlHUmxjM1J5YjNsbFpDY3BPMXh1SUNBZ0lDQWdjbVYwZFhKdU8xeHVJQ0FnSUgxY2JseHVJQ0FnSUd4bGRDQm5iQ0E5SUhSb2FYTXVYMlJsZG1salpTNWZaMnc3WEc0Z0lDQWdaMnd1WkdWc1pYUmxRblZtWm1WeUtIUm9hWE11WDJkc1NVUXBPMXh1SUNBZ0lIUm9hWE11WDJSbGRtbGpaUzVmYzNSaGRITXVkbUlnTFQwZ2RHaHBjeTVpZVhSbGN6dGNibHh1SUNBZ0lIUm9hWE11WDJkc1NVUWdQU0F0TVR0Y2JpQWdmVnh1WEc0Z0lDOHFLbHh1SUNBZ0tpQkFiV1YwYUc5a0lIVndaR0YwWlZ4dUlDQWdLaUJBY0dGeVlXMGdlMDUxYldKbGNuMGdiMlptYzJWMFhHNGdJQ0FxSUVCd1lYSmhiU0I3UVhKeVlYbENkV1ptWlhKOUlHUmhkR0ZjYmlBZ0lDb3ZYRzRnSUhWd1pHRjBaU2h2Wm1aelpYUXNJR1JoZEdFcElIdGNiaUFnSUNCcFppQW9kR2hwY3k1ZloyeEpSQ0E5UFQwZ0xURXBJSHRjYmlBZ0lDQWdJR052Ym5OdmJHVXVaWEp5YjNJb0oxUm9aU0JpZFdabVpYSWdhWE1nWkdWemRISnZlV1ZrSnlrN1hHNGdJQ0FnSUNCeVpYUjFjbTQ3WEc0Z0lDQWdmVnh1WEc0Z0lDQWdhV1lnS0dSaGRHRWdKaVlnWkdGMFlTNWllWFJsVEdWdVozUm9JQ3NnYjJabWMyVjBJRDRnZEdocGN5NWZZbmwwWlhNcElIdGNiaUFnSUNBZ0lHTnZibk52YkdVdVpYSnliM0lvSjBaaGFXeGxaQ0IwYnlCMWNHUmhkR1VnWkdGMFlTd2dZbmwwWlhNZ1pYaGpaV1ZrTGljcE8xeHVJQ0FnSUNBZ2NtVjBkWEp1TzF4dUlDQWdJSDFjYmx4dUlDQWdJR3hsZENCbmJDQTlJSFJvYVhNdVgyUmxkbWxqWlM1ZloydzdYRzRnSUNBZ2JHVjBJR2RzVlhOaFoyVWdQU0IwYUdsekxsOTFjMkZuWlR0Y2JseHVJQ0FnSUdkc0xtSnBibVJDZFdabVpYSW9aMnd1UVZKU1FWbGZRbFZHUmtWU0xDQjBhR2x6TGw5bmJFbEVLVHRjYmlBZ0lDQnBaaUFvSVdSaGRHRXBJSHRjYmlBZ0lDQWdJR2xtSUNoMGFHbHpMbDlpZVhSbGN5a2dlMXh1SUNBZ0lDQWdJQ0JuYkM1aWRXWm1aWEpFWVhSaEtHZHNMa0ZTVWtGWlgwSlZSa1pGVWl3Z2RHaHBjeTVmWW5sMFpYTXNJR2RzVlhOaFoyVXBPMXh1SUNBZ0lDQWdmU0JsYkhObElIdGNiaUFnSUNBZ0lDQWdZMjl1YzI5c1pTNTNZWEp1S0NkaWRXWm1aWEpFWVhSaElITm9iM1ZzWkNCdWIzUWdjM1ZpYldsMElEQWdZbmwwWlhNZ1pHRjBZU2NwTzF4dUlDQWdJQ0FnZlZ4dUlDQWdJSDBnWld4elpTQjdYRzRnSUNBZ0lDQnBaaUFvYjJabWMyVjBLU0I3WEc0Z0lDQWdJQ0FnSUdkc0xtSjFabVpsY2xOMVlrUmhkR0VvWjJ3dVFWSlNRVmxmUWxWR1JrVlNMQ0J2Wm1aelpYUXNJR1JoZEdFcE8xeHVJQ0FnSUNBZ2ZTQmxiSE5sSUh0Y2JpQWdJQ0FnSUNBZ1oyd3VZblZtWm1WeVJHRjBZU2huYkM1QlVsSkJXVjlDVlVaR1JWSXNJR1JoZEdFc0lHZHNWWE5oWjJVcE8xeHVJQ0FnSUNBZ2ZWeHVJQ0FnSUgxY2JpQWdJQ0JuYkM1aWFXNWtRblZtWm1WeUtHZHNMa0ZTVWtGWlgwSlZSa1pGVWl3Z2JuVnNiQ2s3WEc0Z0lIMWNibHh1SUNCblpYUWdZMjkxYm5RZ0tDa2dlMXh1SUNBZ0lISmxkSFZ5YmlCMGFHbHpMbDl1ZFcxV1pYSjBhV05sY3p0Y2JpQWdmVnh1ZlZ4dVhHNWxlSEJ2Y25RZ1pHVm1ZWFZzZENCV1pYSjBaWGhDZFdabVpYSTdYRzRpWFgwPSJdfQ==